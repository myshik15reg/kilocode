function handleAPIRequest(req, res) {
  // Implement rate limiting to prevent abuse
  const rateLimit = 100; // requests per minute
  const windowMs = 60 * 1000; // 1 minute in milliseconds
  const now = Date.now();
  const windowStart = now - windowMs;

  // Initialize request count if it doesn't exist
  if (!req.app.locals.requestCounts) {
    req.app.locals.requestCounts = [];
  }

  // Remove old requests from the window
  req.app.locals.requestCounts = req.app.locals.requestCounts.filter(
    timestamp => timestamp > windowStart
  );

  // Check if the request limit has been exceeded
  if (req.app.locals.requestCounts.length >= rateLimit) {
    res.status(429).send('Too many requests, please try again later.');
    return;
  }

  // Add the current request to the count
  req.app.locals.requestCounts.push(now);

  processRequest(req, res);
}